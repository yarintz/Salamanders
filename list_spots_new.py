# -*- coding: utf-8 -*-
"""
Created on Mon Aug 22 16:13:56 2022

@author: user
"""

import numpy as np
from sklearn.datasets import load_digits
from matplotlib import pyplot as plt
from sklearn.decomposition import TruncatedSVD
float_formatter = lambda x: "%.2f" % x
np.set_printoptions(formatter={'float_kind':float_formatter})
from sklearn.ensemble import RandomForestClassifier
import cv2
from queue import PriorityQueue
from scipy import ndimage
from matplotlib import pyplot as plt
import numpy as np
from skimage import measure
from skimage import filters
import matplotlib.pyplot as plt
from collections import Counter
float_formatter = lambda x: "%.2f" % x
np.set_printoptions(formatter={'float_kind':float_formatter})
from scipy import ndimage
from find_head import head_tail
import pickle
import pandas as pd


# AH181967_1_AH181967_2 =[[2,1],
#             [1,2],
#             [4,4],
#             [3,5],
#             [6,7],
#             [5,6],
#             # [7,8],
#             [8,9],
#             [9,11],
#             [11,13],
#             [10,10],
#             [13,12],[15,14],[12,15],[14,16],[16,18],[17,19],[18,17],
#             [19,20],[20,21],[21,22],[22,24],[23,23],[24,26],[25,27],[26,25],[27,28],[28,29],
#             [30,30],[31,32],[32,34],[33,35],[34,36],[36,37],[38,40],[37,39],[39,41],[35,38],
#             [41,43],#seems  different 
#             [40,42],[42,44],[43,46],[44,47]]           




# pickle.dump( AH181967_1_AH181967_2, open("AH181967_1_AH181967_2.p", "wb" ) )


# AH181967_1_AH181967_3 =[[2,4],[4,9],[6,8],[1,1],[3,2],[5,3],[8,13],[9,7],[11,14],[10,5],[12,10],
#                         [14,16],[16,24],[17,12],[18,6],[19,11],[20,17],[21,20],[22,19],[23,15],
#                         [24,22],[25,21],[26,18],[27,27],[29,32],[28,30],[30,29],[31,31],[32,34],
#                         [33,36],[34,35],[36,39],[35,38],[37,41],[38,42],[39,43],[40,44],[41,45],
#                         [42,46],[43,48],[44,49]]




# pickle.dump( AH181967_1_AH181967_3, open("AH181967_1_AH181967_3.p", "wb" ) )


# # AH181967_1_AH181967_4 =[[1,4],[2,45],[4,44],[6,42],[1,43],[3,41],[5,40],[13,39],[15,37],[8,38],
# #                         [11,35],[9,36],[16,32],[14,34],[12,31],[10,33],[17,30],[18,29],[19,28],
# #                         #[20,27],#merged spots
# #                         #[22,26],
# #                         [23,25],[25,24],[26,23],[27,22],[28,21],[31,19],
# #                         [32,18],[36,13],[33,15],[34,16],[35,14],[37,12],[39,10],[38,9]
# #                         ,[40,8],[41,7],[42,6],[43,8],[44,2],[45,1],[46,4]]


# # pickle.dump( AH181967_1_AH181967_4, open("AH181967_1_AH181967_4.p", "wb" ) )

# AH181967_1_AH181967_5 =[[2,5],[4,7],[6,8],[1,3],[3,4],[5,6],[8,10],[9,9],[11,12],[13,14],[10,11],[12,13],
#                         [14,17],[16,20],[17,18],[18,16],[19,19],
#                        # [20,22],merged spots
#                         [22,24],[23,21],[24,27],
#                         [25,25],[26,23],[27,31],[29,34],[28,29],[30,28],[31,30],[32,36],[33,38],
#                         [36,39],[34,45],[35,26],[37,32],
#                         [39,33],[38,37],[40,35],[41,40],[42,41],[43,43],[44,42],[45,44],[46,46]]


# pickle.dump( AH181967_1_AH181967_5, open("AH181967_1_AH181967_5.p", "wb" ) )

# AH181967_1_AH181967_6 =[[2,5],[4,9],[6,10],[1,1],[3,2],[5,3],[7,4],
#                         # [8,13], merged spots
#                         [9,7],[11,16],[10,6],
#                         [12,11],[16,24],[13,27],[15,28],[17,14],[18,8],[19,12],
#                         # [21,25], merged spots
#                         [22,21],
#                         [23,18],[24,26],[25,23],[27,29],[29,34],[28,30],[31,32],[32,36],[33,37],[36,40],
#                         [34,38],[35,35],[37,39],[38,41],[39,42],[41,44],[40,43],[42,45],[43,46],
#                         [44,48],[45,50],[46,49]]


# pickle.dump( AH181967_1_AH181967_6, open("AH181967_1_AH181967_6.p", "wb" ) )

# # #######

# AH181967_2_AH181967_3 =[[1,4],[4,9],[7,8],[2,1],[5,2],[6,3],[9,13],[11,7],[13,14],[10,5],[13,10],[16,16],[18,24],
#                         [12,23],[14,25],[19,12],[17,6],[20,11],[21,17],[22,20],
#                         [26,22],[24,19],[23,15],
#                         [27,21],
#                         [25,18],
#                         [29,27],[31,32],[29,30],[30,29],
#                         [32,31],[33,33],[34,34],[35,36],[37,39],[36,35],[38,38],
#                         [39,41],[41,43],[40,42],[42,44],[43,45],[44,46],[46,48],
#                         [47,49]]


# pickle.dump( AH181967_2_AH181967_3, open("AH181967_2_AH181967_3.p", "wb" ) )


# # AH181967_2_AH181967_4 =[[1,45],[4,44],[7,42],[2,43],[5,41],[6,40],[10,33],[9,38],[11,36],
# #                         [13,35],[12,39],[14,37],[15,31],[16,34],[18,32],[19,30],[17,29],
# #                         [20,28],[21,27],[26,24],[23,25],[25,23],[24,26],
# #                         [28,22],[29,21],[30,20],[32,19],[34,18],[35,15],[37,13],[36,16],
# #                         [37,13],[38,14],[39,12],
# #                         [41,10],[39,12],[40,9],[42,8],[43,7],[44,6],[46,3],[47,2]]


# # pickle.dump( AH181967_2_AH181967_4, open("AH181967_2_AH181967_4.p", "wb" ) )

# AH181967_2_AH181967_5 =[[1,5],[4,7],[7,8],[2,3],[5,4],[6,6],[9,10],[11,9],[13,12],[12,14],[14,15],
#                         [10,11],[15,13],[16,17],[18,20],[19,18],[17,16],[20,19],
#                         [21,22],[24,24],[26,27],[27,25],[23,21],[25,23],[28,31],[29,29],[32,30],
#                         [30,28],[34,36],[35,38],[37,39],[38,26],[36,45],[39,32],[41,33],[42,35],[40,37],
#                         [43,40],[44,41],[46,43],[47,42],
#                         ]


# pickle.dump( AH181967_2_AH181967_5, open("AH181967_2_AH181967_5.p", "wb" ) )


# AH181967_2_AH181967_5 =[[1,5],[4,7],[7,8],[2,3],[5,4],[6,6],[9,10],[11,9],[13,12],[12,14],[14,15],
#                         [10,11],[15,13],[16,17],[18,20],[19,18],[17,16],[20,19],
#                         [21,22],[24,24],[26,27],[27,25],[23,21],[25,23],[28,31],[29,29],[32,30],
#                         [30,28],[34,36],[35,38],[37,39],[38,26],[36,45],[39,32],[41,33],[42,35],[40,37],
#                         [43,40],[44,41],[46,43],[47,42]]
                        


# pickle.dump( AH181967_2_AH181967_5, open("AH181967_2_AH181967_5.p", "wb" ) )


# AH181967_2_AH181967_6 =[[1,5],[4,9],[7,10],[2,1],[5,2],[6,3],[8,4],[10,6],[11,7],[9,13],[11,7],
#                         [13,16],[15,11],[16,17],[18,24],[12,27],[14,28],[19,14],[17,8],[20,12],
#                         # [21,19],
#                         # [22,25],
#                         [24,21],[23,18],[26,26],[27,23],[28,31],[31,34],[29,30],
#                         [32,32],[34,36],[35,37],[37,40],[36,38],[38,35],[39,39],[41,42],[42,43],
#                         [40,41],[43,44],[44,45],[46,46],[47,48]]
                        


# pickle.dump( AH181967_2_AH181967_6, open("AH181967_2_AH181967_6.p", "wb" ) )


# # AH181967_3_AH181967_4 =[[4,45],[9,44],[8,42],[1,43],[2,41],[3,40],[23,39],[25,37],[5,33],[13,38],
# #                         [7,36],[14,35],[10,31],[16,34],[24,32],[12,30],[6,29],[11,28],[17,27],[19,26],
# #                         [15,25],[18,23],[21,24],[27,22],[30,21],[29,20],[31,19],[34,18],[36,15],[39,13],[35,16],
# #                         [38,14],[41,12],[43,10],[44,8],[42,9],[45,7],[46,6],[48,3],[49,2],
# #                         [47,1],[40,4],[37,5]]


# # pickle.dump( AH181967_3_AH181967_4, open("AH181967_3_AH181967_4.p", "wb" ) )




# AH181967_3_AH181967_5 =[[4,5],[9,7],[8,8],[1,3],[2,4],[3,6],[13,10],[7,9],[14,12],[10,13],[5,11],[16,17],[24,20],
#                         [23,14],[25,15],[12,18],[6,16],[11,19],
#                         # [17,22],
#                         [19,24],[15,21],[18,23],[22,27],[21,25],
#                         [27,31],[32,34],[30,29],[29,28],[31,30],[34,36],[36,38],[39,39],[35,45],[42,37],[41,32],[43,33],[44,35],
#                         [45,40],[46,41],[48,43],[49,42],[47,44],[40,46],[37,47]]


# pickle.dump( AH181967_3_AH181967_5, open("AH181967_3_AH181967_5.p", "wb" ) )



# AH181967_3_AH181967_6 =[[4,5],[9,9],[8,10],[1,1],[2,2],[3,3],
#                         # [13,15],
#                         [7,7],[14,16],[5,6],[10,11],[16,17],[24,24],[23,27],[25,28],
#                         # [17,22],
#                         # [20,25],
#                         [12,14],
#                         [6,8], 
#                         [11,12],[19,21],[15,18],[22,26],[21,23],[27,29],[32,34],[30,30],[31,32],[35,38],[34,36],[36,37],[39,40],[38,35],[41,39],
#                         [42,41],[43,42],[44,43],[45,44],[46,45],[48,46],[49,48],[47,50],[40,49],[37,47]         ]


# pickle.dump( AH181967_3_AH181967_6, open("AH181967_3_AH181967_6.p", "wb" ) )


# pd_4_5_6 =pd.read_csv('AH181956_4__5_6.csv')
def create_new_list(col1,col2,l):
    for z in zip(col1,col2):
        if(not np.isnan(z).any()):
            l.append([int(z[0]), int(z[1])])
    return l

# def new_matching_spots(df, new_list, i,j):
#     new_list = create_new_list(df["i"],df["j"],new_list)
#     pickle.dump( new_list, open(str(new_list)+".p", "wb" ) )
#     return new_list

# AH181967_4_AH181967_5 =[]
# AH181967_4_AH181967_5=create_new_list(pd_4_5_6["4"],pd_4_5_6["5"],AH181967_4_AH181967_5)
# pickle.dump( AH181967_4_AH181967_5, open("AH181967_4_AH181967_5.p", "wb" ) )

# AH181967_4_AH181967_6 =[]
# AH181967_4_AH181967_6=create_new_list(pd_4_5_6["4"],pd_4_5_6["6"],AH181967_4_AH181967_6)
# pickle.dump( AH181967_4_AH181967_6, open("AH181967_4_AH181967_6.p", "wb" ) )

# AH181967_5_AH181967_6 =[]
# AH181967_5_AH181967_6=create_new_list(pd_4_5_6["5"],pd_4_5_6["6"],AH181967_5_AH181967_6)
# pickle.dump( AH181967_5_AH181967_6, open("AH181967_5_AH181967_6.p", "wb" ) )

# ###############################
# #AH181983

# AH181983_spots =pd.read_csv('AH181983_spots.csv')
# AH181983_2_AH181983_3 =[]
# AH181983_2_AH181983_3=create_new_list(AH181983_spots["2"],AH181983_spots["3"],AH181983_2_AH181983_3)
# pickle.dump( AH181983_2_AH181983_3, open("AH181983_2_AH181983_3.p", "wb" ) )
# #
# AH181983_2_AH181983_4 =[]
# AH181983_2_AH181983_4=create_new_list(AH181983_spots["2"],AH181983_spots["4"],AH181983_2_AH181983_4)
# pickle.dump( AH181983_2_AH181983_4, open("AH181983_2_AH181983_4.p", "wb" ) )
# #
# AH181983_3_AH181983_4 =[]
# AH181983_3_AH181983_4=create_new_list(AH181983_spots["3"],AH181983_spots["4"],AH181983_3_AH181983_4)
# pickle.dump( AH181983_3_AH181983_4, open("AH181983_3_AH181983_4.p", "wb" ) )
# ###############################
# #AH1819116

# AH1819116_spots =pd.read_csv('AH1819116.csv')
# AH1819116_2_AH1819116_3 =[]
# AH1819116_2_AH1819116_3 = create_new_list(AH1819116_spots["2"],AH1819116_spots["3"],AH1819116_2_AH1819116_3)
# pickle.dump( AH1819116_2_AH1819116_3, open("AH1819116_2_AH1819116_3.p", "wb" ) )
# #
# #2,4
# AH1819116_spots =pd.read_csv('AH1819116.csv')
# AH1819116_2_AH1819116_4 =[]
# AH1819116_2_AH1819116_4 = create_new_list(AH1819116_spots["2"],AH1819116_spots["4"],AH1819116_2_AH1819116_4)
# pickle.dump( AH1819116_2_AH1819116_4, open("AH1819116_2_AH1819116_4.p", "wb" ) )
# #
# #3,4
# AH1819116_spots =pd.read_csv('AH1819116.csv')
# AH1819116_3_AH1819116_4 =[]
# AH1819116_3_AH1819116_4 = create_new_list(AH1819116_spots["3"],AH1819116_spots["4"],AH1819116_3_AH1819116_4)
# pickle.dump( AH1819116_3_AH1819116_4, open("AH1819116_3_AH1819116_4.p", "wb" ) )
# #########
# #AH181965
# #1,2



AH181965_spots =pd.read_csv('AH181965.csv')
AH181965 ={}
s="AH181965"
for i in range(1,6):
    for j in range(i+1,6):
        l = []
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH181965[(i,j)] = create_new_list(AH181965_spots[str(i)],AH181965_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) )

        
    
AH181964_spots =pd.read_csv('AH181964.csv')
AH181964 ={}
s="AH181964"
for i in range(1,5):
    for j in range(i+1,5):
        l = []
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH181964[(i,j)] = create_new_list(AH181964_spots[str(i)],AH181964_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) )  
    

AH171823_spots =pd.read_csv('AH171823.csv')
AH171823 ={}
s="AH171823"
list_1 =[1,2,3,4,5]
list_2 = [2,3,4,5]
for i in list_1:
    for j in list_2:
        l = []
        print(i)
        print(j)
        print("--------------")
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH171823[(i,j)] = create_new_list(AH171823_spots[str(i)],AH171823_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) )  

# AH171823_spots =pd.read_csv('AH171823_1+2+3+5.csv')
# AH171823 ={}
# s="AH171823"
# list_1 =[1,2,3,5]
# list_2 = [2,3,5]
# for i in list_1:
#     for j in list_2:
#         l = []
#         print(i)
#         print(j)
#         print("--------------")
#         pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
#         AH171823[(i,j)] = create_new_list(AH171823_spots[str(i)],AH171823_spots[str(j)],l)
#         pickle.dump( l, open(pickfilename +".p", "wb" ) )  


AH181983_spots =pd.read_csv('AH181983.csv')
AH181983 ={}
s="AH181983"
list_1 =[2,3,4]
list_2 = [3,4]
for i in list_1:
    for j in list_2:
        l = []
        print(i)
        print(j)
        print("--------------")
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH181983[(i,j)] = create_new_list(AH181983_spots[str(i)],AH181983_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) )  

AH1819116_spots =pd.read_csv('AH1819116.csv')
AH1819116 ={}
s="AH1819116"
list_1 =[1,2,4]
list_2 = [2,4]
for i in list_1:
    for j in list_2:
        l = []
        print(i)
        print(j)
        print("--------------")
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH1819116[(i,j)] = create_new_list(AH1819116_spots[str(i)],AH1819116_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) ) 
        
AH181967_spots =pd.read_csv('AH181967.csv')
AH181967 ={}
s="AH181967"
list_1 =[1,2,4,6]
list_2 = [2,4,6]
for i in list_1:
    for j in list_2:
        l = []
        print(i)
        print(j)
        print("--------------")
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH181967[(i,j)] = create_new_list(AH181967_spots[str(i)],AH181967_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) ) 

AH171801_spots =pd.read_csv('AH171801.csv')
AH171801 ={}
s="AH171801"
list_1 =[1,2,3]
list_2 = [2,3]
for i in list_1:
    for j in list_2:
        l = []
        print(i)
        print(j)
        print("--------------")
        pickfilename=s+ r"_"+ str(i)+ r"_"+ s + r"_"+ str(j)
        AH171801[(i,j)] = create_new_list(AH171801_spots[str(i)],AH171801_spots[str(j)],l)
        pickle.dump( l, open(pickfilename +".p", "wb" ) ) 











































